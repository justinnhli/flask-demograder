{% extends "base.html" %}

{% block title %}Demograder{% endblock %}

{% block breadcrumb %}
    &gt; <a href="{{ url_for('demograder.course_view', course_id=course.id) }}">{{ course.course_number }}</a>
    &gt; {{ assignment.name }}
    &gt; <a href="{{ url_for('demograder.submission_view', question_id=question.id) }}">{{ question.name }}</a>
    &gt; <a href="{{ url_for('demograder.submission_view', submission_id=submission.id) }}">{{ submission.iso_format }} submission</a>
    &gt; <a href="{{ url_for('demograder.result_view', result_id=result.id) }}">result</a>
{% endblock %}

{% block content %}
    <h1>
        {{ question.name }} {{ submission.iso_format }} submission
        {% if role >= Role.INSTRUCTOR %}
        <span class="edit-link">
            <a href="{{ url_for('demograder.reevaluate_result', result_id=result.id) }}">re-run result</a>
        </span>
        {% endif %}
    </h1>

    <h2>Submitted File(s)</h2>
    {% if result.submission.files %}
    <ul>
    {% for submission_file in result.submission.files %}
        <li>
            <a href="{{ url_for('demograder.submission_file_view', submission_file_id=submission_file.id) }}"><code>{{ submission_file.question_file.filename }}</code></a>
            {% if submission_file.filename != submission_file.question_file.filename %}
            (originally <code>{{ submission_file.filename }}</code>)
            {% endif %}
        </li>
    {% endfor %}
    </ul>
    {% endif %}

    {% if result.dependent_files %}
    <h2>Other File(s)</h2>
    <ul>
    {% for submission_file in result.dependent_files %}
        {% if result.question_dependency(submission_file.question.id).viewable %}
        <li>
            <a href="{{ url_for('demograder.submission_file_view', submission_file_id=submission_file.id) }}"><code>{{ submission_file.question_file.filename }}</code></a>
            {% if (instructor or submission_file.submitter == viewer) and submission_file.filename != submission_file.question_file.filename %}
            (originally <code>{{ submission_file.filename }}</code>)
            {% endif %}
        </li>
        {% else %}
        <li><code>{{ submission_file.question_file.filename }}</code> (hidden)</li>
        {% endif %}
    {% endfor %}
    </ul>
    {% endif %}

    <h2>Result</h2>
    {% if result.passed %}
    Pass
    {% elif result.failed %}
    Fail
    {% else %}
    TBD
    {% endif %}

    {% if not question.hide_output %}
    <h2>Output</h2>
    <pre><code>{{ result.stdout }}</code></pre>

    {% if result.stderr %}
    <h2>Errors</h2>
    <pre><code>{{ result.stderr }}</code></pre>
    {% endif %}
    {% endif %}

{% endblock %}
