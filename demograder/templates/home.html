{% extends "base.html" %}

{% block title %}Demograder{% endblock %}

{% block content %}
    <h2>
        Courses
        {% if role >= Role.INSTRUCTOR %}
        <span class="edit-link">(
            <a href="{{ url_for('demograder.course_form') }}">new course</a>
        )</span>
        {% endif %}
    </h2>
    {% for course in viewer.courses() %}
    <ul>
        <li><a href="{{ url_for('demograder.course_view', course_id=course.id) }}">
            {{ course.course_number }} {{ course.title }} ({{ course.semester }})
        </a></li>
    </ul>
    {% endfor %}
    {% if viewer.submissions_from_students(limit=1).first() %}
    <h2>Recent Submissions in Your Courses</h2>
    <table class="submissions-history-table">
        <tr>
            <th>Time</th>
            <th>Course</th>
            <th>Question</th>
            <th>Submitter</th>
            <th>Tests Passed</th>
        </tr>
        {% for submission in viewer.submissions_from_students(limit=10) %}
        <tr>
            <td>{{ submission.iso_format }}</td>
            <td><a href="{{ url_for('demograder.course_view', course_id=submission.question.assignment.course.id) }}">
                {{ submission.question.assignment.course }}
            </a></td>
            <td><a href="{{ url_for('demograder.question_view', question_id=submission.question.id) }}">
                {{ submission.iso_format }}
            </a></td>
            <td><a href="{{ url_for('demograder.user_view', page_user_email=submission.submitter.email) }}">
                {{ submission.submitter.full_name }}
            </a></td>
            <td><a href="{{ url_for('demograder.submission_view', submission_id=submission.id) }}">
                {{ submission.num_passed }} / {{ submission.num_results }}
            </a></td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    {% if viewer.submissions().first() %}
    <h2>Your Recent Submissions</h2>
    <table class="submissions-history-table">
        <tr>
            <th>Time</th>
            <th>Course</th>
            <th>Question</th>
            <th>Tests Passed</th>
        </tr>
        {% for submission in viewer.submissions(limit=10) %}
        <tr>
            <td>{{ submission.iso_format }}</td>
            <td><a href="{{ url_for('demograder.course_view', course_id=submission.question.assignment.course.id) }}">
                {{ submission.question.assignment.course }}
            </a></td>
            <td><a href="{{ url_for('demograder.question_view', question_id=submission.question.id) }}">
                {{ submission.assignment.name }}: {{ submission.question.name }}
            </a></td>
            <td><a href="{{ url_for('demograder.submission_view', submission_id=submission.id) }}">
                    {{ submission.num_passed }} / {{ submission.num_results }}
            </a></td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
{% endblock %}
