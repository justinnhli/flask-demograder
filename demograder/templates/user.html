{% extends "base.html" %}

{% block title %}Demograder{% endblock %}

{% block content %}
    <h1>
        {{ page_user.full_name }} (<a href="mailto:{{ page_user.email }}">{{ page_user.email }}</a>)
    </h1>

    {% for course in courses %}
    <h2>
        <a href="{{ url_for('demograder.course_view', course_id=course.id) }}">
            {{ course.course_number }}: {{ course.title }}
        </a>
        ({{ course.semester }})
        {% if viewer.admin or viewer.is_teaching(course.id) %}
        <span class="edit-link">(
            <a href="{{ url_for('demograder.course_form', course_id=course.id) }}">edit</a>,
            <a href="{{ url_for('demograder.assignment_form', course_id=course.id) }}">new assignment</a>
        )</span>
        {% endif %}
    </h2>
    {% if not page_user.course_submissions(course.id, limit=1).first() %}
    <p>{{ page_user.full_name }} have not yet submitted to this course.</p>
    {% else %}
    <p>Recent Submissions</p>
    <table class="submissions-history-table">
        <tr>
            <th>Time</th>
            <th>Question</th>
            <th>Tests Passed</th>
        </tr>
        {% for submission in page_user.course_submissions(course.id, limit=10) %}
        <tr>
            <td>{{ submission.iso_format }}</td>
            <td><a href="{{ url_for('demograder.question_view', question_id=submission.question.id) }}">{{ submission.assignment.name }}: {{ submission.question.name }}</a></td>
            <td><a href="{{ url_for('demograder.submission_view', submission_id=submission.id) }}">{{ submission.num_passed }} / {{ submission.num_results }}</a></td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    {% endfor %}
{% endblock %}
